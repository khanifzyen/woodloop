<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WoodLoop - Jual Limbah</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="mobile-frame">
        <div class="content-scroll">
            <div style="display: flex; align-items: center; margin-bottom: 24px;">
                <button onclick="history.back()"
                    style="background: none; border: none; font-size: 24px; margin-right: 16px;">‚Üê</button>
                <h2>Setor Limbah</h2>
            </div>

            <form onsubmit="handleWasteSubmit(event)">
                <!-- Photo Upload -->
                <div class="form-group">
                    <label class="form-label">Foto Limbah</label>
                    <div style="border: 2px dashed #ccc; padding: 40px; text-align: center; border-radius: 12px; background: #f9f9f9;"
                        onclick="document.getElementById('fileInput').click()">
                        <div style="font-size: 32px; margin-bottom: 8px;">üì∑</div>
                        <div style="font-size: 12px; color: #888;">Ketuk untuk ambil foto</div>
                        <input type="file" id="fileInput" style="display: none;" accept="image/*"
                            onchange="previewImage(this)">
                    </div>
                    <img id="preview" src="https://images.unsplash.com/photo-1595846519845-68e298c2edd8?w=100&q=80"
                        style="width: 100%; height: 100%; object-fit: cover; display: none;">
                </div>

                <!-- Wood Type -->
                <div class="form-group">
                    <label class="form-label">Jenis Kayu</label>
                    <select class="form-input" id="wasteType" required>
                        <option value="">Pilih Jenis Kayu</option>
                        <option value="Jati (Teak)">Jati (Teak)</option>
                        <option value="Mahoni (Mahogany)">Mahoni (Mahogany)</option>
                        <option value="Sungkai">Sungkai</option>
                        <option value="Trembesi">Trembesi</option>
                        <option value="Campuran/Lainnya">Campuran/Lainnya</option>
                    </select>
                </div>

                <!-- Weight -->
                <div class="form-group">
                    <label class="form-label">Estimasi Berat (Kg)</label>
                    <input type="number" class="form-input" id="wasteWeight" placeholder="Contoh: 50" required
                        oninput="calculatePrice()">
                </div>

                <!-- Price Estimate -->
                <div class="form-group" style="background: #E8F5E9; padding: 16px; border-radius: 12px;">
                    <label class="form-label" style="color: var(--primary-color);">Estimasi Pendapatan</label>
                    <div style="font-size: 24px; font-weight: 700; color: var(--primary-color);" id="priceEstimate">Rp 0
                    </div>
                    <div style="font-size: 10px; color: #666; margin-top: 4px;">*Berdasarkan harga pasar rata-rata</div>
                </div>

                <button type="submit" class="btn btn-primary mt-4">Kirim & Jual</button>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        function previewImage(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('imagePreview').src = e.target.result;
                    document.getElementById('imagePreview').style.display = 'block';
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        function calculatePrice() {
            const weight = document.getElementById('wasteWeight').value || 0;
            // Mock price logic: 1kg = Rp 3000
            const price = weight * 3000;
            document.getElementById('priceEstimate').textContent = formatRupiah(price);
        }

        function handleWasteSubmit(event) {
            event.preventDefault();

            const type = document.getElementById('wasteType').value;
            const weight = document.getElementById('wasteWeight').value;
            const price = weight * 3000;
            const image = document.getElementById('preview').src !== '' && document.getElementById('preview').style.display !== 'none' ? document.getElementById('preview').src : 'https://images.unsplash.com/photo-1595846519845-68e298c2edd8?w=100&q=80';

            const newData = {
                id: 'INV-' + Math.floor(Math.random() * 10000),
                type: type,
                weight: weight,
                price: price,
                image: image,
                timestamp: new Date().getTime(),
                status: 'Menunggu Penjemputan'
            };

            saveWasteData(newData);
            navigateTo('generator-success.html');
        }
    </script>
</body>

</html>